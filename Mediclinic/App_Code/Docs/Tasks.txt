
old email settings:

    <add key="ErrorAlertEmail_SMTPHost"         value="smtp.gmail.com" />
    <add key="ErrorAlertEmail_SMTPPort"         value="587" />
    <add key="ErrorAlertEmail_AccountUsername"  value="nadadanini@gmail.com" />
    <add key="ErrorAlertEmail_AccountPassword"  value="FattyMcGee" />


=======================
  Extra Hours Worked:
=======================


--------------------------------------------------------------------
  Brought forward: Total in lieu = 44.5    (& used 4 days holiday)
--------------------------------------------------------------------


Days off:
songkran            - 4 days (then was easter friday)
tu-fr 10/6-13/6 apr - 4 days (mo was queens birthday)
16-18 july          - 3 days off
hong kong 9/2014    - 2 days off
shoulder 4/11/2014  - 2 weeks
new year 2014-2015  - 4 days off


==========
  Tasks:
==========

__________________________________________________________________________________________________________




==> add medical service type into notes ....


[done] => add to db -- AND STUBDB
[done] 
[done] => add to classes
[done] 
[done] => add to 
[done] notelistv2 --- if gp site .. open wider popup
[done] notev2     --- not needed for bookings





[done] In the claim level, remove:
[done] 
[done]  ReferringProviderNum
[done]  ReferralIssueDate
[done]  ReferralPeriodTypeCde
[done] 
[done] In the service level, add:
[done] 
[done]  <NoOfPatientsSeen>0</NoOfPatientsSeen>
[done]  <AfterCareOverrideInd>N</AfterCareOverrideInd>
[done]  <DuplicateServiceOverrideInd>N</DuplicateServiceOverrideInd>
[done]  <MultipleProcedureOverrideInd>N</MultipleProcedureOverrideInd>
[done]  <HospitalInd>N</HospitalInd>
[done]    ChargeAmount (already in there)
[done]  <ServiceText></ServiceText>
[done] 
[done] We know to use GP Hinx ... if provider fieldID = 1
[done] 
[done] *** if gp ... ignore epc referral ...when doing hinx

GP:
- list other people with same MC nbr (ignore family nbr) - these are family members
- list of notes TODO list ... that is deletable .. called "Alerts" (or similar - to discuss with PT)

Need to be able to have both GP and Clinic Site


==> gap payments 
inv pt but mc claim pt ( pg 14 field 5-17 )
new invoice type ?



***** change so that:

- have function to get PT Detail Link (if gp site, return V3, else V2)
- pt list page (and other pages) - use that
- in V3, if pt is not GP patient, then go to V2
- no more going to V3 auto



voucher - cash sale invoice - shown inv list

	[done] an invoice is the payment for a (list of) products/services
	[done] so ... you want an invoice for the purchase of a voucher
	[done] => add to invoice line table     ---- to STUB DB ALSO!!
    [done] ALTER TABLE InvoiceLine ADD credit_id int FOREIGN KEY REFERENCES Credit(credit_id) default null;   
	[done] 
	[done] => can not edit voucher amount any more. .. need to reverse the voucher (and therefore invoice) first
	[done] => when reversing voucher .. need to reverse invoice ... and also check if any payments on it that need to be reversed






I should get an email for PT reminders for Site40 ... for 8am Saturday Booking (only if it sends reminders for classes)
did not come ... need to add reminders for class bookings


Next Available 
- Auto Run Submit On First Page Load
- If whole column not availble, just remove it from the items to display





if PT "is_a_company"
	- hide first name and first name validation
	- change surname text to Company Name
	- change existing to suanrme = firstname + ' ' + surname

	DECLARE @Database VARCHAR(255)
	DECLARE @cmd varchar(1000)

	DECLARE DatabaseCursor CURSOR FOR 
	SELECT name FROM master.sys.databases  
	WHERE state_desc='ONLINE' AND (name LIKE 'Mediclinic_[0-9][0-9][0-9][0-9]' OR name = 'Mediclinic_FakeDB')
	Order by 1

	OPEN DatabaseCursor  
	FETCH NEXT FROM DatabaseCursor INTO @Database 
	WHILE @@FETCH_STATUS = 0 
	BEGIN 
		SET @cmd='use ['+@Database+']; IF (select count(*) from Patient where is_company = 1) > 0 BEGIN Select ''' + @Database + ''', firstname, surname,* from Patient LEFT JOIN PERSON ON Patient.person_id = Person.person_id where is_company = 1 END' 
		EXEC (@cmd)
		FETCH NEXT FROM DatabaseCursor INTO @Database 
	END 
	CLOSE DatabaseCursor  
	DEALLOCATE DatabaseCursor




priority
- all or only 1 clinic : admin
  need whole new user ... maybe we can have 2 types of external staff memebers? ... one full and one cut down?


pre-pay class
	This is not Credit. 
	It is an actual Receipt (cash, credit card, etc).
	But with no invoice ... it is linked to
		pre_pay_booking_id
		pre_pay_entity_id  (pr or fac)
	Need to allow Receipt to have no invoice (but some other linking id to org or patient) ... then show these when completing bookings?





TODO:


1. TYRO
2. Back to GP portal!



>  need BK slot to show if have other cards (mc/dva/ins)





----------------------------
check all menu groups for different logins
so know what to put in totally different lines for new menu types
----------------------------
[done] chart for staff stats
[done] chart for orgs stats
----------------------------
AC PT Types
DVA - need one row per profession due to different codes
Prob same as MC
----------------------------
put in unsubscribe ilnk in emails

PatientDB.GetUnsubscribeLink(int patient_id)  
  <== can get DB itself .. and can encode it same as ezidebit link encoding

Then put in page:
  Unsuscribe.aspx (that doesn't need to be logged in - same as ezidebit payment)
  and unsets all emails and phone numbers for non-billing

-- dont seperate advertising out ... its just billing and non-billing 
----------------------------


time columns every 5 providers in bk sheet
gift voucher (credit)
use a mic and save talking into a booking as a wav file

---

maybe:
bk schedule page & hours worked report
- if clinic with all provs selected, show in grid only provs assigned (plus any with extra booknigs) and remove the others
- if prov with all clinics selected, show in grid only clinics assigned (plus any with extra booknigs) and remove the others


---

commission page  - show providers at top ... then other non-deleted staff below
cash sale page - if item sold by that person ... shows commission

- page to show comissions for sales between date (can select by provider or all, or by clinic or all)

---

ability for patients to add themself to a group booking
- talk to marcus if this is a security or privacy issue ... because if they can add to one group booking, they can add themself to any

---

resource = room or kits 

----------------------------

scanned docs

Done .. just need to put it into GP site ... with medical service type id in url (optional)



------------------------------------------------------------------------

------
 Tyro
------



* * * * * * * * * * * * * * * * * * * * * * * * * * *
        start the healthpoint reconcilliation
* * * * * * * * * * * * * * * * * * * * * * * * * * *



http://localhost:2524/TyroHealthPointClaimV2.aspx?invoice=334585&debug=1



==========>> start on healthcard claiming screen
file:///C:/Users/Eli/Desktop/iclient-api/doc/classes/TYRO.IClientWithUI.html#method_initiateHealthPointClaim

reconcilliation via HTTP Get:
https://tyropayments.atlassian.net/wiki/pages/viewpage.action?spaceKey=INT&title=Web+Integration+Specification#WebIntegrationSpecification-The%22IntegratedReportingandReconciliation%22Operations


http://developer.tyro.com
Username: pos-467
Password: Mediclinic$

https://tyropayments.atlassian.net/wiki/pages/viewpage.action?pageId=10059780
http://robertjdavidson.github.io/iclient-sample/

tyro - payment processor
not only credit cards and debit cards, does 
private healthfunds claimed through hicaps terminal

URL: http://developer.tyro.com
Username: pos-467
Password: Mediclinic$

  899/900 (any TID e.g. 1) 
  200 200


For everything other than EFTPOS (payment) reports in the simulator (which needs 200/200), you can use MID 99906 and TID 1. 
Please use the details on this page for which amounts to use:
https://integrationsimulator.test.tyro.com/docs/
Also please use this provider ID 4237955J



[done] => purcahse/cashout, refunds
[done] => reconcilliation
=> healthcard claiming


		----------------------------------------------------------

		SELECT * FROM TyroPaymentPending
		--SELECT * FROM TyroPaymentType
		--DELETE TyroPaymentPending

		----------------------------------------------------------

		CREATE Table TyroPaymentType
		(
		 tyro_payment_type_id  int            not null PRIMARY KEY identity,
		 descr                 varchar(50)    not null
		);

		SET IDENTITY_INSERT TyroPaymentType ON;
		INSERT INTO TyroPaymentType 
		 (tyro_payment_type_id,descr)
		Values
		 (1, 'Purchase'),
		 (2, 'Refund')
		SET IDENTITY_INSERT TyroPaymentType OFF;

		CREATE TABLE TyroPaymentPending
		(
		 tyro_payment_pending_id           int           not null PRIMARY KEY identity,

		 invoice_id                        int           not null FOREIGN KEY REFERENCES Invoice(invoice_id),
		 tyro_transaction_id               varchar(50)   not null,     -- for reconcilliation "[DB]-[tyro_payment_pending_id]"  eg.  0001-304904
		 tyro_payment_type_id              int           not null FOREIGN KEY REFERENCES TyroPaymentType(tyro_payment_type_id),
		 amount                            decimal(8,2)  not null,
		 cashout                           decimal(8,2)  not null,
		 date_added                        datetime      not null,

		 out_date_processed                datetime      DEFAULT NULL, -- date out params entered into the system
		 out_result                        varchar(100)  not null,
		 out_cardType                      varchar(100)  not null,
		 out_transactionReference          varchar(100)  not null,
		 out_authorisationCode             varchar(100)  not null,
		 out_issuerActionCode              varchar(100)  not null,
		);

		----------------------------------------------------------

		CREATE TABLE TyroHealthClaim
		(
			tyro_health_claim_id                        int           not null PRIMARY KEY identity,
			invoice_id                                  int           not null FOREIGN KEY REFERENCES Invoice(invoice_id),
			tyro_transaction_id                         varchar(50)   not null,     -- for reconcilliation "[DB]-[tyro_health_claim_id]"  eg.  0001-304904
			amount                                      decimal(8,2)  not null,
			date_added                                  datetime      not null,

			out_date_processed							datetime      DEFAULT NULL,
			out_result									varchar(100)  not null,     -- "APPROVED"
			out_healthpointRefTag						varchar(100)  not null,     -- "7417220"
			out_healthpointTotalBenefitAmount			decimal(8,2)  not null,     -- "8600"
			out_healthpointSettlementDateTime			datetime      DEFAULT NULL, -- "20150424165436"
			out_healthpointTerminalDateTime				datetime      DEFAULT NULL, -- "20150424165436"
			out_healthpointMemberNumber					varchar(100)  not null,     -- "0000000000"
			out_healthpointProviderId					varchar(100)  not null,     -- "4237955J"
			out_healthpointServiceType					varchar(100)  not null,     -- "F"
			out_healthpointGapAmount					decimal(8,2)  not null,     -- "0"
			out_healthpointPhfResponseCode				varchar(100)  not null,     -- "00"
			out_healthpointPhfResponseCodeDescription	varchar(500)  not null,     -- "APPROVED"
			date_cancelled                              datetime      DEFAULT NULL,
		);

		CREATE TABLE TyroHealthClaimItem
		(
			tyro_health_claim_item_id                   int           not null PRIMARY KEY identity,
			tyro_health_claim_id                        int           not null FOREIGN KEY REFERENCES TyroHealthClaim(tyro_health_claim_id),

			out_claimAmount				                decimal(8,2)  not null,     -- "6800"
			out_rebateAmount			                decimal(8,2)  not null,     -- "6800"
			out_serviceCode				                varchar(100)  not null,     -- "F1234"
			out_description				                varchar(500)  not null,     -- "Face"
			out_serviceReference		                varchar(100)  not null,     -- "01"
			out_patientId				                varchar(100)  not null,     -- "47"
			out_serviceDate				                datetime      DEFAULT NULL, -- "20150423"
			out_responseCodeString		                varchar(100)  not null,     -- "0000"
		);

		----------------------------------------------------------




------------------------------------------------------------------------

Only have - LC/HC/etc
No DVA/Medicare/TAC at all.
Then don't need second one for when runs out

If using DVA card then bill by DVA
Same for MC/TAC

Else bill by normal way

------------------------------------------------------------------------

SELECT * FROM Staff 
         LEFT JOIN Person ON Staff.person_id = person.person_id
WHERE staff_id = -4

SELECT * FROM Patient
         LEFT JOIN Person ON patient.person_id = person.person_id
WHERE added_by = 3
 
SELECT * FROM Booking	WHERE added_by = -4

------------------------------------------------------------------------

LAST Priority - ie don't do it!

Discounts/Penalty pricing (by org .. & with something else I think)


**do this same time as do gap-payments per individual offering


discounts

need a way to change prices per item
... per clinic ...per day of week

need to put changed price in org-offerings page ... 

so ... can have no normal price .. but can have change up or down

mo up% mo up-amt ... tue/wed/....


and checkbox next to each to switch on or off .... or else just change to 0

------------------------------------------------------------------------

>> for invoices (or bookings?) have last_inv_sent_date
>> any time created or printed or emailed .. set last sent date to that

>> do we want this for overdue auto invoices also?



================================================================================================================================================================


Questionairres
--------------

BELOW WILL NOT WORK

	Need:

	Questionnaire
	QuestionnaireSection (with type)
	QuestionnaireSectionType
	- [descr after ] checkboxes (each item no more than 40 or so chars to fit 2 or 3 cols per page?) ... need "Other" textbox ?
	- [descr before] free text short (1 line - descr max like 40 or so chars, single line textbox right after )
	- [descr before] free text long  (multiple lines - text box below)
	       - [descr before] rating (5 checkboxes 1-5)  ... fuck this .. can use short text and write number 1-5!


	- same line  - short question long answer  (q < 40, an < 150 ?)
	- same line  - long question  short answer (q < 150 a < 40 ?)
	- 2 lines    - long question  long answer  (1 line each)
	- multi line - long question  long answer  (q - long ... a - multi-line 

	"Our records show that you got care from your healthcare provider. Is that right?" : Yes


	QuestionnaireItem 
	- if section type checkboxes .. only allow items with names and checkboxes  (need 'other' free text ?)
	- if section type free text  .. only allow free text





Questionairres

1. Questionnaire        (questionnaire_id, descr)

- is_deleted              bit not null,

2. QuestionnaireSection (questionnaire_section_id, questionnaire_id, descr) 

- show_non_selected_items bit not null -- or prob just auto show all ... then can leave this out?? -- then lighter (grey?) for non selected items
- display_order           int not null
- is_deleted              bit not null

3. QuestionnaireItem    (questionnaire_item_id, questionnaire_section_id, descr)

 questionnaire_item_id    int           not null PRIMARY KEY identity,
 questionnaire_section_id int           not null FOREIGN KEY REFERENCES QuestionnaireSection(questionnaire_section_id),
 descr                    varchar(2000) not null,
 show_date                bit           not null,
 show_nweeksdue           bit           not null,
 show_text                bit           not null,
 display_order            int           not null,
 is_deleted               bit           not null,
 
 
4. QuestionnaireItemAnswer

 questionnaire_item_answer_id int           not null PRIMARY KEY identity,
 patient_id                   int                   FOREIGN KEY REFERENCES Patient(patient_id),
 questionnaire_item_id        int                   FOREIGN KEY REFERENCES QuestionnaireItem(questionnaire_item_id),
 date                         date,
 nweeksdue                    int           not null,
 text                         varchar(2000) not null,
 is_deleted                   bit           not null,
 CONSTRAINT uc_unique_patient_condition UNIQUE (patient_id,questionnaire_item_id)
 

================================================================================================================================================================


   GP Site
   -------
Declare @entity_id int
INSERT INTO Entity DEFAULT VALUES;
SET @entity_id = SCOPE_IDENTITY()
INSERT Site VALUES (@entity_id, 'Mediclinic GP Site', '','','','',0,'0','','','','',0,1,  0,0,0,0,0,0,0,  '08:00:00','12:00:00','13:00:00','18:00:00','2014-06-30 00:00:00',36,3)

insert into Letter (organisation_id,letter_type_id,site_id,code,docname,is_send_to_medico,is_allowed_reclaim,is_manual_override,num_copies_to_print,reject_message,is_deleted)
select organisation_id,letter_type_id,3,code,docname,is_send_to_medico,is_allowed_reclaim,is_manual_override,num_copies_to_print,reject_message,is_deleted
from letter where site_id = 2

-- UPDATE Patient SET is_gp_patient = 1 WHERE patient_id = 54950




MedicalServiceType
   - HOSPITAL
   - RADIOLOGY
   - PATHOLOGY
   - SPECIALIT SERVICES

Note - add fields:
   - medical_service_type_id

Uploaded file ... can put into pt folder of medical_service_type_id
   eg:
   31456/1 (ID:1 = HOSPITAL)
   31456/2 (ID:2 = RADIOLOGY)
   etc



HealthCard (ie EPC)
   - add medical_service_type_ids (list ?)








[[ALERGIES - FLASHING RED  [PATIENT NOTE, NOET BOOKING NOTE] ]]

Tabs:

- REFERRALS (list) - referrals are FROM this GP so keep name who referral is TO .. so use same referral structure 
  grouped by MedicalServiceType (hospial, radiology, pathology, etc)

- (BACKGROUND) MEDICAL HISTORY
   - LIST OF NOTES .. patient notes

- CURRENT CONSULTATIONS (SEEN BOOKING NOTES .. MOST RECENT ON TOP) TO SEE ALL NOTES
   - NOTES - MEANING CURRENT BOOKINGS
   - CURRENT PRESCRIPTIONS (BOOKING TIME PRESCRIBED)

- REFERRAL TEMPLATES  ...RIGHT IN THE PATIENT PAGE
   - BASICALLY LETTER TEMPLATES .. JUST GROUPED INTO DIFFERENT MedicalServiceType groups 


- Attachments
   - really just MedicalInfo .. but instead of note .. is uploaded file
   - grouped into MedicalServiceType

================================================================================================================================================================






TODO
----

__________________________________________________________________________________________________________


add ability to remove all unavailabilties for

org ddl (All, a, b, c ...)  prov ddl (All, a, b, c ...)

put nbr to remove in ddl 
	[Balwyn (304)]
	[Melb Podiatry (78)]
	....

__________________________________________________________________________________________________________


Talk to artem about service to poll pop emails to see what faxes were sent successfull vs failed

__________________________________________________________________________________________________________

select

(select count(*) from Mediclinic_0001.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0003.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0004.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0006.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0008.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0009.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0018.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0021.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0023.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0024.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0025.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0026.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0027.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0028.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0029.dbo.BulkLetterSendingQueue where datetime_sent is null),
(select count(*) from Mediclinic_0030.dbo.BulkLetterSendingQueue where datetime_sent is null)

__________________________________________________________________________________________________________

-- FIX UP CLAIM NUMBERS
UPDATE InvoiceHealthcareClaimNumbers SET last_date_used = 
(
   SELECT top 1 invoice_date_added 
   FROM Invoice 
   WHERE healthcare_claim_number = InvoiceHealthcareClaimNumbers.claim_number 
   ORDER BY invoice_date_added DESC
)

Maybe putting in claim numbers seperrately for doing it when generating hinx files is not updating the claim number table?

__________________________________________________________________________________________________________

http://www.jobnorththailand.com/
http://www.cmprice.com/job.php?content=job_search


C#/ASP.NET Developer

You will be developing web-based software for medical clinic management

Requirements:
1. Bachelor's degree in Computer Science or similar
2. Strong understanding of concepts in: OOP, MVC, Layered design
3. C#/ASP.NET experience
4. DB design, SQL
5. HTML/CSS/JS/AJAX
6. Good analytical and problem solving skills
7. Can communicate in English

If this sounds like you, please send me your resume

__________________________________________________________________________________________________________
